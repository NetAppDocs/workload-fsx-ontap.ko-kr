---
sidebar: sidebar 
permalink: create-replication.html 
keywords: replication, replicate, data protection, disaster recovery, data loss 
summary: FSx for ONTAP 파일 시스템에 대한 복제 관계를 생성하여 예기치 않은 재해가 발생할 경우 데이터 손실을 방지합니다. 
---
= NetApp Workload Factory에서 FSx for ONTAP으로 데이터를 복제
:allow-uri-read: 
:icons: font
:imagesdir: ./media/


[role="lead"]
예기치 못한 재해 발생 시 데이터 손실을 방지하려면 NetApp Workload Factory에서 FSx for ONTAP 파일 시스템에 대한 복제 관계를 생성하십시오. 두 FSx for ONTAP 파일 시스템 간 또는 온프레미스 ONTAP 시스템과 FSx for ONTAP 파일 시스템 간에 데이터를 복제할 수 있습니다.

스토리지 VM 마이그레이션을 위해서는 복제 관계를 생성한 직후에 컷오버 작업을 완료해야 합니다.



== 이 작업에 대해

복제는 재해가 해당 지역에 영향을 미칠 경우 데이터를 보호하며, 마이그레이션 목적으로도 사용할 수 있습니다.

타겟 파일 시스템의 복제된 볼륨은 데이터 보호(DP) 볼륨이며 다음과 같은 명명 형식을 `{OriginalVolumeName}_copy` 따릅니다.

불변 파일이 포함된 소스 볼륨을 복제하면 소스 볼륨의 보존 기간이 종료될 때까지 타겟 볼륨과 파일 시스템이 잠긴 상태로 유지됩니다. 불변 파일 기능은 FSx for ONTAP 파일 시스템에 대해 link:create-volume.html["볼륨을 생성하다"]할 때 사용할 수 있습니다.

[NOTE]
====
* iSCSI 또는 NVMe 프로토콜을 사용하는 블록 볼륨의 경우 복제가 지원되지 않습니다.
* 소스(읽기/쓰기) 볼륨 1개 또는 데이터 보호(DP) 볼륨을 복제할 수 있습니다. 계단식 복제는 지원되지만 세 번째 홉은 지원되지 않습니다. 에 대해 자세히 link:https://review.docs.netapp.com/us-en/workload-fsx-ontap_cascade-replication/cascade-replication.html["계단식 복제"^]알아보십시오.


====


=== 마이그레이션 사용 사례

마이그레이션 사용 사례를 선택할 때 단일 스토리지 VM에 대해 스토리지 VM 데이터와 구성 설정을 복제하도록 선택적으로 선택할 수 있습니다. 데이터와 구성 설정을 동시에 마이그레이션할 경우 지난 24시간 이내에 볼륨에 대한 마지막 복제가 완료되었는지 확인하십시오. 이 기능을 사용하려면 동일한 스토리지 VM에 있는 모든 볼륨을 선택해야 합니다. 모든 볼륨의 계층화 정책은 기본적으로 소스 볼륨의 계층화 정책으로 설정되며, 이는 마이그레이션 사용 사례에 권장됩니다.

Workload Factory는 다음 스토리지 시스템 간의 마이그레이션 복제를 지원합니다.

* 온프레미스 ONTAP 시스템 및 FSx for ONTAP 파일 시스템
* Cloud Volumes ONTAP 및 FSx for ONTAP 파일 시스템
* FSx for ONTAP 및 FSx for ONTAP 파일 시스템
+
** 1세대에서 1세대로
** 1세대에서 2세대로
** 2세대에서 2세대로




스토리지 VM 데이터 및 구성 설정을 마이그레이션하려면 두 가지 작업을 완료해야 합니다.

. <<복제 관계를 생성합니다,복제 관계를 생성합니다>>사용 사례로 *Migration*을 선택하고 *Replicate storage VM configuration*을 선택합니다.
. <<마이그레이션 사용 사례를 위한 컷오버 복제,마이그레이션 사용 사례를 위한 컷오버 복제>> 소스 파일 시스템의 데이터 및 구성 설정을 타겟 FSx for ONTAP 파일 시스템으로 영구적으로 마이그레이션합니다.




== 복제 관계를 생성합니다

두 FSx for ONTAP 파일 시스템 간 또는 온프레미스 ONTAP 시스템과 FSx for ONTAP 파일 시스템 간에 데이터를 복제합니다.

.시작하기 전에
시작하기 전에 다음 요구 사항을 검토하십시오.

* 복제 관계에서 타겟으로 사용할 FSx for ONTAP 파일 시스템이 하나 있어야 합니다.
* 복제 관계에 사용하는 FSx for ONTAP 파일 시스템에는 연결된 링크가 있어야 합니다. link:https://docs.netapp.com/us-en/workload-fsx-ontap/create-link.html["기존 링크를 연결하는 방법이나 새 링크를 만들고 연결하는 방법을 알아보세요."]. 링크를 연결한 후, 이 작업으로 돌아오십시오.
* 온프레미스 ONTAP 시스템에서 FSx for ONTAP 파일 시스템으로 복제하려면 온프레미스 ONTAP 시스템을 검색했는지 확인하십시오.
* 볼륨 상태가 사용 가능, 생성됨 또는 잘못 구성됨 이외의 상태이거나 ONTAP 버전이 호환되지 않는 경우 복제가 지원되지 않습니다.
* 마이그레이션 사용 사례의 경우 스토리지 VM 데이터 및 구성 설정과의 복제 관계를 생성하기 전에 볼륨에 대한 마지막 복제가 지난 24시간 이내에 완료되었는지 확인하십시오.


.단계
. 중 하나를 사용하여 link:https://docs.netapp.com/us-en/workload-setup-admin/console-experiences.html["콘솔 환경"^]로그인합니다.
. 메뉴를 선택하세요 image:workloads-menu-icon.png["햄버거 메뉴 아이콘은 스토리지, EDA, AI, 데이터베이스, VMware 및 관리와 같은 워크로드로 이동하는 데 사용됩니다."] 그런 다음 *저장소*를 선택하세요.
. 저장소 메뉴에서 *FSx for ONTAP*를 선택합니다.
. *FSx for ONTAP*에서 복제할 볼륨이 포함된 파일 시스템을 선택합니다.
. 파일 시스템의 모든 볼륨을 복제하거나 선택한 볼륨을 복제합니다.
+
** 파일 시스템의 모든 볼륨을 복제하려면 파일 시스템 개요에서 * Replicate data * 를 선택합니다.
** 선택한 볼륨을 복제하려면 파일 시스템 개요에서 * Volumes * 탭을 선택합니다.
+
Volumes 테이블에서 하나 이상의 볼륨을 선택한 다음 * Replicate data * 를 선택합니다.



. 데이터 복제 페이지의 복제 타겟에서 다음을 제공합니다.
+
.. *사용 사례*: 복제에 대한 다음 사용 사례 중 하나를 선택하세요.  선택한 사용 사례에 따라 Workload Factory는 모범 사례에 따라 권장 값으로 양식을 채웁니다.  권장되는 값을 수락하거나 양식을 작성하면서 변경할 수 있습니다.
+
*** 마이그레이션: 데이터를 대상 FSx for ONTAP 파일 시스템으로 전송합니다
+
*스토리지 VM 구성 복제*: 선택적으로 단일 스토리지 VM의 스토리지 VM 데이터 및 구성 설정을 복제하도록 선택합니다. 데이터와 구성 설정을 동시에 마이그레이션할 경우 지난 24시간 이내에 볼륨에 대한 마지막 복제가 완료되었는지 확인하십시오. 이 기능을 사용하려면 동일한 스토리지 VM에 있는 모든 볼륨을 선택해야 합니다. 모든 볼륨의 계층화 정책은 기본적으로 소스 볼륨의 계층화 정책으로 설정되며, 이는 마이그레이션 사용 사례에 권장됩니다.

*** 핫 재해 복구: 중요한 워크로드에 대한 고가용성 및 신속한 재해 복구를 보장합니다
*** 콜드 또는 아카이브 재해 복구:
+
**** 콜드 재해 복구: 더 긴 RTO(복구 시간 목표) 및 RPO(복구 시점 개체)를 사용하여 비용을 절감합니다
**** 아카이브: 장기 스토리지 및 규정 준수를 위해 데이터 복제


*** 기타
+
또한 사용 사례를 선택하여 복제 정책 또는 ONTAP(SnapMirror policy)를 결정합니다. 복제 정책을 설명하는 데 사용되는 용어는 에서 가져온 link:https://docs.netapp.com/us-en/ontap/data-protection/default-protection-policies-concept.html["ONTAP 9 설명서"^]것입니다.

+
**** 마이그레이션 및 기타 의 경우 복제 정책을 _MirrorAllSnapshots_라고 합니다. _MirrorAllSnapshots_은(는) 모든 스냅샷과 최신 활성 파일 시스템을 미러링하기 위한 비동기 정책입니다.
**** 핫, 콜드 또는 아카이브 재해 복구의 경우 복제 정책을 _MirrorAndVault_라고 합니다. _MirrorAndVault_는 최신 활성 파일 시스템과 일별 및 주별 스냅샷을 미러링하기 위한 비동기 및 볼트 정책입니다.
+
모든 활용 사례에서 장기 보존을 위해 스냅샷을 활성화하면 기본 복제 정책은 _MirrorAndVault_입니다.





.. * FSx for ONTAP 파일 시스템 *: 대상 FSx for ONTAP 파일 시스템에 대한 자격 증명, 지역 및 FSx for ONTAP 파일 시스템 이름을 선택합니다.
.. * 스토리지 VM 이름 *: 드롭다운 메뉴에서 스토리지 VM을 선택합니다. 선택한 스토리지 VM은 이 복제 관계에서 선택한 모든 볼륨의 대상입니다.
.. * 볼륨 이름 * : 대상 볼륨 이름은 다음 형식으로 자동으로 `{OriginalVolumeName}_copy`생성됩니다. 자동 생성된 볼륨 이름을 사용하거나 다른 볼륨 이름을 입력할 수 있습니다.
.. * Tiering policy *: 타겟 볼륨에 저장된 데이터에 대한 계층화 정책을 선택합니다. 계층화 정책은 기본적으로 선택한 활용 사례에 대해 권장되는 계층화 정책으로 설정됩니다.
+
Workload Factory 콘솔을 사용하여 볼륨을 생성할 때 기본 계층화 정책은 _균형(자동)_입니다.  볼륨 계층화 정책에 대한 자세한 내용은 다음을 참조하세요.link:https://docs.aws.amazon.com/fsx/latest/ONTAPGuide/volume-storage-capacity.html#data-tiering-policy["볼륨 스토리지 용량"^] AWS FSx for NetApp ONTAP 문서.  Workload Factory는 계층화 정책에 대해 Workload Factory 콘솔에서 사용 사례 기반 이름을 사용하고 FSx for ONTAP 계층화 정책 이름을 괄호 안에 포함합니다.

+
마이그레이션 사용 사례를 선택한 경우 Workload Factory는 소스 볼륨의 계층화 정책을 대상 볼륨으로 자동으로 복사합니다.  계층화 정책을 복사하려면 선택을 취소하고 복제를 위해 선택한 볼륨에 적용되는 계층화 정책을 선택합니다.

.. * 최대 전송 속도 *: * 제한 * 을 선택하고 최대 전송 제한(MB/s)을 입력합니다 또는 * 무제한 * 을 선택합니다.
+
제한이 없으면 네트워크 및 애플리케이션 성능이 저하될 수 있습니다. 또는 중요한 워크로드(예: 재해 복구에 주로 사용되는 워크로드)에 FSx for ONTAP 파일 시스템에 대해 무제한 전송 속도를 사용하는 것이 좋습니다.



. Replication settings(복제 설정) 에서 다음을 제공합니다.
+
.. * 복제 간격 *: 소스 볼륨에서 타겟 볼륨으로 스냅샷이 전송되는 빈도를 선택합니다.
.. *장기 보존*: 장기 보존을 위해 스냅샷을 선택적으로 사용할 수 있습니다. 장기 보존을 통해 전체 사이트 장애가 발생하더라도 비즈니스 서비스를 계속 운영할 수 있으므로, 보조 복사본을 사용하여 애플리케이션을 투명하게 페일오버할 수 있습니다.
+
장기 보존이 없는 복제는 _MirrorAllSnapshots_ 정책을 사용합니다. 장기 보존을 활성화하면 복제에 _MirrorAndVault_ 정책이 할당됩니다.

+
장기 보존을 사용하도록 설정한 경우 기존 정책을 선택하거나 새 정책을 생성하여 복제할 스냅샷 및 유지할 스냅샷 수를 정의합니다.

+

NOTE: 장기간 보존을 위해서는 소스 및 타겟 레이블이 일치해야 합니다. 원하는 경우 워크로드 공장에서 누락된 레이블을 생성할 수 있습니다.

+
*** * 기존 정책 선택 *: 드롭다운 메뉴에서 기존 정책을 선택합니다.
*** *새 정책 만들기*: *정책 이름*을 입력하세요.


.. *변경 불가능한 스냅샷*: 선택 사항. 보존 기간 동안 이 정책에서 생성한 스냅샷이 삭제되지 않도록 하려면 * 변경 불가능한 스냅샷 활성화 * 를 선택합니다.
+
*** 보존 기간 * 을 시간, 일, 월 또는 년 수로 설정합니다.
*** * Snapshot policies *: 표에서 스냅샷 정책 빈도와 유지할 복제본 수를 선택합니다. 두 개 이상의 스냅샷 정책을 선택할 수 있습니다.


.. *S3 액세스 포인트*: 선택적으로 AWS S3 API를 통해 NFS 또는 SMB/CIFS 볼륨에 있는 FSx for ONTAP 파일 시스템 데이터에 액세스하기 위해 S3 액세스 포인트를 연결합니다. 파일 접근 유형만 지원됩니다. 다음 세부 정보를 제공합니다.
+
*** *S3 액세스 포인트 이름*: S3 액세스 포인트의 이름을 입력하세요.
*** *사용자*: 볼륨에 액세스할 수 있는 기존 사용자를 선택하거나 새 사용자를 만듭니다.
*** *사용자 유형*: 사용자 유형으로 *UNIX* 또는 *Windows*를 선택합니다.
*** *네트워크 구성*: *인터넷* 또는 *Virtual private cloud (VPC)*를 선택하십시오. 선택한 네트워크 유형에 따라 액세스 포인트가 인터넷에서 접근 가능한지 또는 특정 VPC로 제한되는지가 결정됩니다.
*** *메타데이터 활성화*: 메타데이터를 활성화하면 S3 액세스 포인트에서 액세스할 수 있는 모든 객체가 포함된 S3 테이블이 생성되며, 이를 감사, 거버넌스, 자동화, 분석 및 최적화에 사용할 수 있습니다. 메타데이터를 활성화하면 추가 AWS 비용이 발생합니다. 자세한 내용은 link:https://aws.amazon.com/s3/pricing/["Amazon S3 가격 책정 문서"^]을(를) 참조하십시오.


.. *S3 액세스 포인트 태그*: 선택적으로 최대 50개의 태그를 추가할 수 있습니다.




. Create * 를 선택합니다.


.결과
복제 관계는 대상 FSx for ONTAP 파일 시스템의 * 복제 관계 * 탭에 표시됩니다.

마이그레이션을 위해 복제 관계를 생성한 경우 스토리지 VM 데이터 및 구성 설정을 타겟 FSx for ONTAP 파일 시스템으로 마이그레이션하려면 모든 볼륨과 해당 스토리지 VM을 컷오버해야 합니다.



== 마이그레이션 사용 사례를 위한 컷오버 복제

마이그레이션 사용 사례를 위한 복제 관계를 생성한 후에는 스토리지 VM 데이터 및 구성 설정을 타겟 FSx for ONTAP 파일 시스템으로 마이그레이션하려면 컷오버 복제를 수행해야 합니다. 컷오버 복제는 소스 파일 시스템에서 타겟 FSx for ONTAP 파일 시스템으로 데이터 및 스토리지 VM 구성 설정을 영구적으로 마이그레이션합니다. 컷오버 과정에서 데이터는 마지막으로 복제됩니다. 시스템은 컷오버가 완료되면 소스 볼륨을 삭제합니다. 이 작업은 되돌릴 수 없습니다.

.시작하기 전에
시작하기 전에 다음 요구 사항을 검토하십시오.

* 복제를 전환하기 전에 스토리지 VM에 대한 모든 클라이언트 액세스를 중지하십시오.
* 복제를 전환하기 전에 모든 소스 볼륨에서 데이터가 제공되지 않는지 확인하십시오.
* 복제 전환을 수행하기 전에 소스 볼륨과 타겟 볼륨 간의 데이터 동기화가 완료되었는지 확인하십시오.
* 복제 관계에 사용하는 FSx for ONTAP 파일 시스템에는 연결된 링크가 있어야 합니다. link:https://docs.netapp.com/us-en/workload-fsx-ontap/create-link.html["기존 링크를 연결하는 방법이나 새 링크를 만들고 연결하는 방법을 알아보세요."]. 링크를 연결한 후, 이 작업으로 돌아오십시오.


.단계
. 중 하나를 사용하여 link:https://docs.netapp.com/us-en/workload-setup-admin/console-experiences.html["콘솔 환경"^]로그인합니다.
. 메뉴를 선택하세요 image:workloads-menu-icon.png["햄버거 메뉴 아이콘은 스토리지, EDA, AI, 데이터베이스, VMware 및 관리와 같은 워크로드로 이동하는 데 사용됩니다."] 그런 다음 *저장소*를 선택하세요.
. 저장소 메뉴에서 *FSx for ONTAP*를 선택합니다.
. *FSx for ONTAP*에서 복제할 볼륨이 포함된 파일 시스템을 선택합니다.
. *복제 관계* 탭을 선택합니다.
. 복제 관계 테이블에서 전환할 복제 관계를 선택한 다음 *복제 전환*을 선택합니다.
. Cut over replication 대화 상자의 정보를 검토한 다음 _cut over_를 입력하여 확인합니다.


. *Cut over*를 선택하세요.


.결과
전환이 완료되면 소스 볼륨이 삭제되고 타겟 볼륨은 읽기/쓰기 가능 상태가 됩니다. 전환 후 타겟 볼륨에 대해 link:change-tiering-policy.html["계층화 정책을 수정합니다"]할 수 있습니다.
